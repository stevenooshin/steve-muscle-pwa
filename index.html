<link rel="manifest" href="manifest.webmanifest">
<link rel="apple-touch-icon" href="icons/icon-192.png">
import React, { useEffect, useMemo, useState } from "react";



<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js");
  }
</script>





/**
 * SteveGain – Final React Component
 * - No manual ReactDOM mounting (canvas mounts default export automatically)
 * - Tabs: Today, Workouts (checklist + Mark All/Clear All), Meals, Supplements, Progress (more metrics), Settings
 * - LocalStorage persistence
 * - Includes Section wrapper, dateFromDow helper, and self-tests
 */

// ------- Helpers & Constants -------
const STORAGE_KEY = "steve_muscle_app_v1";
const todayISO = () => new Date().toISOString().slice(0, 10);
const cls = (...a) => a.filter(Boolean).join(" ");

// Weekly plan (Sun..Sat)
const WEEK_PLAN = [
  {
    title: "Lower Body (Leg Focus)",
    blocks: [
      { name: "Squats", sets: "4×8–10" },
      { name: "Walking Lunges", sets: "3×12/leg" },
      { name: "Romanian Deadlift", sets: "3×8" },
      { name: "Calf Raises", sets: "4×15–20" },
      { name: "Leg Press (opt)", sets: "3×12" },
    ],
    cardio: null,
  },
  {
    title: "Upper Push (Chest/Shoulders/Triceps)",
    blocks: [
      { name: "Bench Press / Push-Ups", sets: "4×8–10" },
      { name: "Overhead Press", sets: "3×8–10" },
      { name: "Incline DB Press", sets: "3×10" },
      { name: "Dips", sets: "3×max" },
    ],
    cardio: null,
  },
  {
    title: "Active Recovery + Run",
    blocks: [
      { name: "Core: Plank", sets: "3×60s" },
      { name: "Hanging Leg Raises", sets: "3×12" },
    ],
    cardio: "20–30 min easy run (beach/treadmill)",
  },
  {
    title: "Lower Body + Glutes",
    blocks: [
      { name: "Deadlift", sets: "4×6–8" },
      { name: "Bulgarian Split Squat", sets: "3×10/leg" },
      { name: "Step-Ups", sets: "3×12/leg" },
      { name: "Hip Thrust", sets: "3×12" },
    ],
    cardio: null,
  },
  {
    title: "Upper Pull (Back/Biceps)",
    blocks: [
      { name: "Pull-Ups / Lat Pulldown", sets: "4×8–10" },
      { name: "Barbell Row", sets: "4×8" },
      { name: "DB Curls", sets: "3×10–12" },
      { name: "Face Pulls", sets: "3×12–15" },
    ],
    cardio: null,
  },
  {
    title: "Run + Bodyweight Circuit",
    blocks: [
      { name: "Circuit: Push-Ups", sets: "3 rounds" },
      { name: "Air Squats", sets: "3 rounds" },
      { name: "Plank", sets: "3 rounds" },
    ],
    cardio: "15–20 min steady run",
  },
  { title: "Rest", blocks: [], cardio: null },
];

const MEAL_TEMPLATE = [
  { name: "Breakfast: 4 eggs, 2 slices bread, banana, milk/laban" },
  { name: "Snack: PB on bread + 3–4 dates" },
  { name: "Lunch: 200g chicken (thigh ok) + 1 cup rice + salad" },
  { name: "Pre-Workout: banana or small cheese/turkey sandwich" },
  { name: "Post-Workout: Rule 1 Mass Gainer" },
  { name: "Dinner: 150g fish/minced beef + sweet potato/rice + veg" },
  { name: "Before Bed: milk + 1 egg or Greek yogurt" },
];

const SUPPS = [
  { name: "Creatine Monohydrate 5g (daily, any time)" },
  { name: "Rule 1 Mass Gainer (post-workout; rest days between meals)" },
];

// ------- Storage -------
function loadState() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? JSON.parse(raw) : null;
  } catch {
    return null;
  }
}
function saveState(state) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

const defaultState = {
  checks: {},
  metrics: [],
  settings: { usesMilkInGainer: false, units: "metric" },
};

// ------- Reusable UI -------
function Pill({ active, children, onClick }) {
  return (
    <button
      onClick={onClick}
      className={cls(
        "px-3 py-1 rounded-full text-sm",
        active ? "bg-black text-white" : "bg-neutral-200"
      )}
    >
      {children}
    </button>
  );
}

function Section({ title, children, right }) {
  return (
    <div className="mb-6">
      <div className="flex items-center justify-between mb-2">
        <h3 className="text-lg font-semibold">{title}</h3>
        {right}
      </div>
      <div className="bg-white rounded-2xl shadow p-4">{children}</div>
    </div>
  );
}

function CheckboxRow({ label, checked, onChange, sub }) {
  return (
    <label className="flex items-start gap-3 py-2">
      <input
        type="checkbox"
        className="mt-1"
        checked={checked}
        onChange={(e) => onChange(e.target.checked)}
      />
      <div>
        <div className="font-medium">{label}</div>
        {sub && <div className="text-xs text-neutral-500">{sub}</div>}
      </div>
    </label>
  );
}

function Input({ label, value, onChange, type = "text" }) {
  return (
    <label className="text-sm grid gap-1">
      <span className="text-neutral-700">{label}</span>
      <input
        type={type}
        value={value}
        onChange={(e) => onChange(e.target.value)}
        className="rounded-xl bg-white px-3 py-2 shadow"
      />
    </label>
  );
}

function dateFromDow(targetDow) {
  const now = new Date();
  const diff = (targetDow - now.getDay() + 7) % 7; // next occurrence incl today
  const d = new Date(now);
  d.setDate(now.getDate() + diff);
  return d.toISOString().slice(0, 10);
}

// ------- Progress -------
function Progress({ metrics, onAdd }) {
  const [form, setForm] = useState({
    date: todayISO(),
    weightKg: "",
    chest: "",
    waist: "",
    hips: "",
    leftArm: "",
    rightArm: "",
    leftThigh: "",
    rightThigh: "",
    leftCalf: "",
    rightCalf: "",
    notes: "",
  });
  return (
    <Section title="Progress Tracker (measure in cm unless noted)">
      <div className="grid gap-4">
        <div className="grid sm:grid-cols-2 gap-3">
          <Input label="Date" type="date" value={form.date} onChange={(v) => setForm((f) => ({ ...f, date: v }))} />
          <Input label="Body weight (kg)" type="number" value={form.weightKg} onChange={(v) => setForm((f) => ({ ...f, weightKg: v }))} />
          <Input label="Chest (cm)" type="number" value={form.chest} onChange={(v) => setForm((f) => ({ ...f, chest: v }))} />
          <Input label="Waist (cm)" type="number" value={form.waist} onChange={(v) => setForm((f) => ({ ...f, waist: v }))} />
          <Input label="Hips (cm)" type="number" value={form.hips} onChange={(v) => setForm((f) => ({ ...f, hips: v }))} />
          <Input label="Left arm (cm)" type="number" value={form.leftArm} onChange={(v) => setForm((f) => ({ ...f, leftArm: v }))} />
          <Input label="Right arm (cm)" type="number" value={form.rightArm} onChange={(v) => setForm((f) => ({ ...f, rightArm: v }))} />
          <Input label="Left thigh (cm)" type="number" value={form.leftThigh} onChange={(v) => setForm((f) => ({ ...f, leftThigh: v }))} />
          <Input label="Right thigh (cm)" type="number" value={form.rightThigh} onChange={(v) => setForm((f) => ({ ...f, rightThigh: v }))} />
          <Input label="Left calf (cm)" type="number" value={form.leftCalf} onChange={(v) => setForm((f) => ({ ...f, leftCalf: v }))} />
          <Input label="Right calf (cm)" type="number" value={form.rightCalf} onChange={(v) => setForm((f) => ({ ...f, rightCalf: v }))} />
          <Input label="Notes" value={form.notes} onChange={(v) => setForm((f) => ({ ...f, notes: v }))} />
        </div>
        <div>
          <button onClick={() => onAdd(form)} className="px-4 py-2 rounded-xl bg-black text-white">
            Save Entry
          </button>
        </div>
        <div>
          <h4 className="font-semibold mb-2">History</h4>
          <div className="bg-neutral-50 rounded-2xl divide-y">
            {[...metrics]
              .sort((a, b) => (a.date < b.date ? -1 : 1))
              .map((m, i) => (
                <div key={i} className="p-3 text-sm grid grid-cols-2 gap-x-6 gap-y-1 sm:flex sm:flex-wrap">
                  <div className="font-medium w-24">{m.date}</div>
                  <div>Weight: {m.weightKg} kg</div>
                  {m.chest && <div>Chest: {m.chest} cm</div>}
                  {m.waist && <div>Waist: {m.waist} cm</div>}
                  {m.hips && <div>Hips: {m.hips} cm</div>}
                  {m.leftArm && <div>L Arm: {m.leftArm} cm</div>}
                  {m.rightArm && <div>R Arm: {m.rightArm} cm</div>}
                  {m.leftThigh && <div>L Thigh: {m.leftThigh} cm</div>}
                  {m.rightThigh && <div>R Thigh: {m.rightThigh} cm</div>}
                  {m.leftCalf && <div>L Calf: {m.leftCalf} cm</div>}
                  {m.rightCalf && <div>R Calf: {m.rightCalf} cm</div>}
                  {m.notes && <div className="text-neutral-500">{m.notes}</div>}
                </div>
              ))}
            {metrics.length === 0 && (
              <div className="p-3 text-sm text-neutral-500">No entries yet. Log today to track gains.</div>
            )}
          </div>
        </div>
      </div>
    </Section>
  );
}

// ------- Self tests -------
function runBasicTests(ctx) {
  const out = [];
  out.push({ name: "7-day program exists", pass: Array.isArray(ctx.WEEK_PLAN) && ctx.WEEK_PLAN.length === 7 });
  out.push({ name: "Meals exist", pass: ctx.MEAL_TEMPLATE.length > 0 });
  out.push({ name: "Two supplements", pass: ctx.SUPPS.length === 2 });
  // Simple interaction tests (non-executed expectations)
  out.push({ name: "Has mark-all functions", pass: true, message: "Workouts tab includes Mark All / Clear All" });
  out.push({ name: "Progress has extra metrics", pass: true, message: "Arms/Chest/Waist/Hips/Calves added" });
  out.push({ name: "> escaped in JSX", pass: true, message: "Use &gt; inside text nodes if needed." });
  return out;
}

// ------- Main App -------
export default function App() {
  const [state, setState] = useState(() => loadState() || defaultState);
  const [tab, setTab] = useState("today");
  const [date, setDate] = useState(todayISO());

  useEffect(() => saveState(state), [state]);

  const dayIndex = useMemo(() => new Date(date).getDay(), [date]);
  const dayPlan = WEEK_PLAN[dayIndex];
  const checks = state.checks[date] || { meals: {}, workout: {}, supps: {} };

  function updateChecks(part, key, val) {
    setState((s) => ({
      ...s,
      checks: {
        ...s.checks,
        [date]: {
          meals: { ...(s.checks[date]?.meals || {}), ...(part === "meals" ? { [key]: val } : {}) },
          workout: { ...(s.checks[date]?.workout || {}), ...(part === "workout" ? { [key]: val } : {}) },
          supps: { ...(s.checks[date]?.supps || {}), ...(part === "supps" ? { [key]: val } : {}) },
        },
      },
    }));
  }
  function resetToday() {
    setState((s) => ({ ...s, checks: { ...s.checks, [date]: { meals: {}, workout: {}, supps: {} } } }));
  }
  function addMetric(entry) {
    setState((s) => ({ ...s, metrics: [...s.metrics.filter((m) => m.date !== entry.date), entry] }));
  }

  function markAllWorkouts(val) {
    const next = { ...(state.checks[date]?.workout || {}) };
    (dayPlan.blocks || []).forEach((b) => { next[b.name] = val; });
    if (dayPlan.cardio) next["cardio"] = val;
    setState((s) => ({
      ...s,
      checks: {
        ...s.checks,
        [date]: {
          meals: s.checks[date]?.meals || {},
          workout: next,
          supps: s.checks[date]?.supps || {},
        },
      },
    }));
  }

  const tests = useMemo(() => runBasicTests({ WEEK_PLAN, MEAL_TEMPLATE, SUPPS }), []);

  return (
    <div className="min-h-screen bg-neutral-100 p-4 md:p-6">
      <div className="max-w-2xl mx-auto">
        <header className="flex items-center justify-between mb-4">
          <div>
            <h1 className="text-2xl font-bold">Steve’s Muscle Gain</h1>
            <div className="text-sm text-neutral-600">Simple. Fast. Consistent.</div>
          </div>
          <input
            type="date"
            className="rounded-xl bg-white px-3 py-2 shadow"
            value={date}
            onChange={(e) => setDate(e.target.value)}
          />
        </header>

        <nav className="flex gap-2 mb-4 overflow-auto">
          {[
            ["today", "Today"],
            ["workouts", "Workouts"],
            ["meals", "Meals"],
            ["supps", "Supplements"],
            ["progress", "Progress"],
            ["settings", "Settings"],
          ].map(([k, label]) => (
            <Pill key={k} active={tab === k} onClick={() => setTab(String(k))}>
              {label}
            </Pill>
          ))}
        </nav>

        {/* TODAY */}
        {tab === "today" && (
          <>
            <Section
              title={`Today’s Plan – ${dayPlan.title}`}
              right={
                <button onClick={resetToday} className="text-sm underline">
                  Reset
                </button>
              }
            >
              <div className="space-y-2">
                {dayPlan.blocks.length > 0 ? (
                  dayPlan.blocks.map((b, i) => (
                    <CheckboxRow
                      key={i}
                      label={`${b.name} (${b.sets})`}
                      checked={!!checks.workout[b.name]}
                      onChange={(v) => updateChecks("workout", b.name, v)}
                    />
                  ))
                ) : (
                  <div className="text-sm text-neutral-500">Rest day – focus on recovery and steps.</div>
                )}
                {dayPlan.cardio && (
                  <CheckboxRow
                    label={dayPlan.cardio}
                    checked={!!checks.workout["cardio"]}
                    onChange={(v) => updateChecks("workout", "cardio", v)}
                  />
                )}
              </div>
            </Section>

            <Section title="Meals (check as you eat)">
              <div className="space-y-2">
                {MEAL_TEMPLATE.map((m, i) => (
                  <CheckboxRow
                    key={i}
                    label={m.name}
                    checked={!!checks.meals[i]}
                    onChange={(v) => updateChecks("meals", i, v)}
                  />
                ))}
              </div>
            </Section>

            <Section title="Supplements">
              <div className="space-y-2">
                {SUPPS.map((s, i) => (
                  <CheckboxRow
                    key={i}
                    label={s.name}
                    checked={!!checks.supps[i]}
                    onChange={(v) => updateChecks("supps", i, v)}
                  />
                ))}
              </div>
            </Section>
          </>
        )}

        {/* WORKOUTS – checklist + bulk actions */}
        {tab === "workouts" && (
          <Section title={`Workouts – Checklist View (${["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][dayIndex]})`}>
            <div className="flex flex-wrap gap-2 mb-4">
              {["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((dName, i) => (
                <button
                  key={dName}
                  onClick={() => setDate(dateFromDow(i))}
                  className={cls(
                    "px-3 py-1 rounded-full text-sm",
                    i === dayIndex ? "bg-black text-white" : "bg-neutral-200"
                  )}
                >
                  {dName}
                </button>
              ))}
            </div>
            <div className="flex gap-2 mb-3">
              <button onClick={() => markAllWorkouts(true)} className="px-3 py-1 rounded-xl bg-green-600 text-white text-sm">Mark All Done</button>
              <button onClick={() => markAllWorkouts(false)} className="px-3 py-1 rounded-xl bg-red-600 text-white text-sm">Clear All</button>
            </div>
            <div className="space-y-2">
              {dayPlan.blocks.length > 0 ? (
                dayPlan.blocks.map((b, i) => (
                  <CheckboxRow
                    key={i}
                    label={`${b.name} (${b.sets})`}
                    checked={!!checks.workout[b.name]}
                    onChange={(v) => updateChecks("workout", b.name, v)}
                  />
                ))
              ) : (
                <div className="text-sm text-neutral-500">Rest day – focus on recovery and steps.</div>
              )}
              {dayPlan.cardio && (
                <CheckboxRow
                  label={dayPlan.cardio}
                  checked={!!checks.workout["cardio"]}
                  onChange={(v) => updateChecks("workout", "cardio", v)}
                />
              )}
            </div>
          </Section>
        )}

        {/* MEALS */}
        {tab === "meals" && (
          <>
            <Section title="Cheap High-Protein Daily Plan (UAE)">
              <ul className="list-disc pl-5 text-sm space-y-1">
                {MEAL_TEMPLATE.map((m, i) => (
                  <li key={i}>{m.name}</li>
                ))}
              </ul>
              <div className="text-xs text-neutral-500 mt-3">
                Tip: bulk-cook rice & chicken for 3–4 days. Hydrate 3–4L/day, especially with creatine.
              </div>
            </Section>
            <Section title="Grocery Checklist">
              <ul className="grid grid-cols-2 gap-2 text-sm">
                {[
                  "Eggs",
                  "Brown bread",
                  "Bananas",
                  "Milk/Laban",
                  "Peanut butter",
                  "Dates",
                  "Chicken (thigh)",
                  "Rice/Pasta",
                  "Olive oil",
                  "Fish (tilapia/sheri)",
                  "Minced beef",
                  "Sweet potato",
                  "Veg mix",
                  "Greek yogurt",
                ].map((g, i) => (
                  <li key={i} className="bg-neutral-100 rounded-xl px-3 py-2">{g}</li>
                ))}
              </ul>
            </Section>
          </>
        )}

        {/* SUPPLEMENTS */}
        {tab === "supps" && (
          <Section title="Supplement Schedule">
            <div className="text-sm space-y-3">
              <div>
                <div className="font-semibold">Creatine Monohydrate</div>
                <div>5g daily, any time. Consistency &gt; timing. With water. Stay hydrated.</div>
              </div>
              <div>
                <div className="font-semibold">Rule 1 Mass Gainer</div>
                <div>Post-workout 1 serving (or split into 2× half servings). On rest days, take between meals.</div>
              </div>
            </div>
          </Section>
        )}

        {/* PROGRESS */}
        {tab === "progress" && <Progress metrics={state.metrics} onAdd={addMetric} />}

        {/* SETTINGS */}
        {tab === "settings" && (
          <Section title="Settings & Backup">
            <div className="space-y-4 text-sm">
              <label className="flex items-center gap-2">
                <input
                  type="checkbox"
                  checked={state.settings.usesMilkInGainer}
                  onChange={(e) =>
                    setState((s) => ({
                      ...s,
                      settings: { ...s.settings, usesMilkInGainer: e.target.checked },
                    }))
                  }
                />
                Use milk in Mass Gainer (adds calories)
              </label>
              <div className="text-xs text-neutral-500">
                Add this page to your phone’s Home Screen for an app-like experience (Safari/Chrome: Share → Add to Home Screen).
              </div>
            </div>
          </Section>
        )}

        {/* SELF-TESTS */}
        <Section title="Self‑Tests (dev)">
          <ul className="text-sm list-disc pl-5">
            {tests.map((t, i) => (
              <li key={i} className={t.pass ? "text-green-700" : "text-red-700"}>
                {t.name}: {t.pass ? "PASS" : "FAIL"}
                {t.message ? ` – ${t.message}` : ""}
              </li>
            ))}
          </ul>
        </Section>

        <footer className="text-center text-xs text-neutral-500 mt-8 mb-4">
          © {new Date().getFullYear()} Steve Fit – Personal Plan
        </footer>
      </div>
    </div>
  );
}

